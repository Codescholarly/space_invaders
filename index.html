<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Space Game</title>
  <script src="js/phaser.js"></script>
</head>
<body>

    <script type="text/javascript">

    window.onload = function() {


		var game = new Phaser.Game(800,600, Phaser.AUTO, 'phaser-example', { preload: preload, create: create, update: update, render: render });
		var player;
		var aliens;
		var cursors;
		var lasers;
		var laserTime = 0;


		function preload() {

		    game.load.spritesheet('invader', 'img/enemies/enemyRed1.png', 93, 93);
		    game.load.image('ship', 'img/player/playerShip1_blue.png');
     		game.load.image('laser', 'img/lasers/laserBlue01.png');

		}

		function create() {

		    game.physics.startSystem(Phaser.Physics.ARCADE);

		    //  Jugador
		    player = game.add.sprite(400, 500, 'ship');
		    player.anchor.setTo(0.5, 0.5);
		    game.physics.enable(player, Phaser.Physics.ARCADE);

		    //  Enemigos
		    aliens = game.add.group();
		    aliens.enableBody = true;
		    aliens.physicsBodyType = Phaser.Physics.ARCADE;
		
		    //  Laseres
		    lasers = game.add.group();
		    lasers.enableBody = true;
		    lasers.physicsBodyType = Phaser.Physics.ARCADE;
		    lasers.createMultiple(100, 'laser');

            // Crear Enemigos
            // Se crean aliens en 3 filas 5 columnas = 15 aliens
		    for (var y = 0; y < 3; y++)
		    {
		        for (var x = 0; x < 5; x++)
		        {
			       // Se crea cada alien 100px de distancia en x y 80px de distancia en y
		            var alien = aliens.create(x * 100, y * 80, 'invader');
		            alien.anchor.setTo(0.5, 0.5);
		            alien.body.moves = false;
		        }
		    }

		    aliens.x = 100;
		    aliens.y = 50;
	  		    
		    //  Controles de keyboard y mouse
		    cursors = game.input.keyboard.createCursorKeys();
		    fire = game.input.activePointer;

		}


		function update() {

		    if (player.alive)
		    {
		        //  Paramos al pana
		        player.body.velocity.setTo(0, 0);

                // Checkeamos las teclas, nos movemos
		        if (cursors.left.isDown)
		        {
		            player.body.velocity.x = -200;
		        }
		        else if (cursors.right.isDown)
		        {
		            player.body.velocity.x = 200;
		        }
		        else if (cursors.up.isDown)
		        {
		            player.body.velocity.y = -200;
		        }
		        else if (cursors.down.isDown)
		        {
		            player.body.velocity.y = 200;
		        }
		
		        // Dispara si se presiona el mouse
		        if (fire.isDown)
				{
					fireLaser();
				}	

		    }

		}
		
		function render() {
			
		}
		
		function fireLaser() {

		    if (game.time.now > laserTime)
		    {
		        laser = lasers.getFirstExists(false);

		        if (laser)
		        {
		            laser.reset(player.x, player.y + 8);
		            laser.body.velocity.y = -400;
		            laserTime = game.time.now + 200;
		        }
		    }

		}

    };

    </script>
  
</body>
</html>